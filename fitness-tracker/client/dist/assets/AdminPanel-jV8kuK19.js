import{A as d}from"./api-BOpwtc0M.js";import{_ as h,c as l,a as e,t as a,f as U,g as m,j as u,v as c,k as g,F as f,h as y,o}from"./index-BLfcvYJG.js";const v={name:"AdminPanel",data(){return{users:[],formUser:{username:"",password:"",role:"user"},selectedUser:null,loading:!0,page:1,pageSize:5}},computed:{isAdmin(){var i;return((i=this.$store.state.user)==null?void 0:i.role)==="admin"},paginatedUsers(){const i=(this.page-1)*this.pageSize;return this.users.slice(i,i+this.pageSize)},totalPages(){return Math.ceil(this.users.length/this.pageSize)}},async mounted(){this.isAdmin&&await this.fetchUsers()},methods:{async fetchUsers(){try{const{data:i}=await d.get("/users");this.users=i}catch{alert("Error fetching users")}finally{this.loading=!1}},async addUser(){try{await d.post("/users",this.formUser),this.resetForm(),await this.fetchUsers()}catch{alert("Error adding user")}},async updateUser(){try{await d.put(`/users/${this.selectedUser.id}`,this.formUser),this.resetForm(),await this.fetchUsers()}catch{alert("Error updating user")}},async deleteUser(i){try{await d.delete(`/users/${i}`),await this.fetchUsers()}catch{alert("Error deleting user")}},editUser(i){this.selectedUser=i,this.formUser={...i,password:""}},cancelEdit(){this.resetForm()},resetForm(){this.selectedUser=null,this.formUser={username:"",password:"",role:"user"}},prevPage(){this.page>1&&this.page--},nextPage(){this.page<this.totalPages&&this.page++}}},w={key:0,class:"admin-page"},k={class:"form-section"},b={class:"form-buttons"},P={type:"submit"},_={class:"users-section"},A={key:0},E={key:1},x=["onClick"],C=["onClick"],S={class:"pagination"},F=["disabled"],V=["disabled"],z={key:1,class:"no-access"};function M(i,s,N,B,r,n){return n.isAdmin?(o(),l("div",w,[s[10]||(s[10]=e("h2",null,"Admin Panel",-1)),e("section",k,[e("h3",null,a(r.selectedUser?"Edit User":"Add New User"),1),e("form",{onSubmit:s[4]||(s[4]=U(t=>r.selectedUser?n.updateUser():n.addUser(),["prevent"]))},[m(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>r.formUser.username=t),type:"text",placeholder:"Username",required:""},null,512),[[c,r.formUser.username]]),r.selectedUser?u("",!0):m((o(),l("input",{key:0,"onUpdate:modelValue":s[1]||(s[1]=t=>r.formUser.password=t),type:"password",placeholder:"Password",required:""},null,512)),[[c,r.formUser.password]]),m(e("select",{"onUpdate:modelValue":s[2]||(s[2]=t=>r.formUser.role=t)},s[7]||(s[7]=[e("option",{value:"user"},"User",-1),e("option",{value:"admin"},"Admin",-1)]),512),[[g,r.formUser.role]]),e("div",b,[e("button",P,a(r.selectedUser?"Update":"Add"),1),r.selectedUser?(o(),l("button",{key:0,type:"button",onClick:s[3]||(s[3]=(...t)=>n.cancelEdit&&n.cancelEdit(...t)),class:"cancel"},"Cancel")):u("",!0)])],32)]),e("section",_,[s[9]||(s[9]=e("h3",null,"Users",-1)),r.loading?(o(),l("div",A,"Loading users...")):u("",!0),r.loading?u("",!0):(o(),l("table",E,[s[8]||(s[8]=e("thead",null,[e("tr",null,[e("th",null,"Username"),e("th",null,"Role"),e("th",null,"Actions")])],-1)),e("tbody",null,[(o(!0),l(f,null,y(n.paginatedUsers,t=>(o(),l("tr",{key:t.id},[e("td",null,a(t.username),1),e("td",null,a(t.role),1),e("td",null,[e("button",{onClick:p=>n.editUser(t)},"Edit",8,x),e("button",{onClick:p=>n.deleteUser(t.id),class:"danger"},"Delete",8,C)])]))),128))])])),e("div",S,[e("button",{onClick:s[5]||(s[5]=(...t)=>n.prevPage&&n.prevPage(...t)),disabled:r.page===1},"Prev",8,F),e("span",null,"Page "+a(r.page),1),e("button",{onClick:s[6]||(s[6]=(...t)=>n.nextPage&&n.nextPage(...t)),disabled:r.page>=n.totalPages},"Next",8,V)])])])):(o(),l("div",z,s[11]||(s[11]=[e("p",null,"You do not have permission to view this page.",-1)])))}const I=h(v,[["render",M],["__scopeId","data-v-acffaef2"]]);export{I as default};
//# sourceMappingURL=AdminPanel-jV8kuK19.js.map
