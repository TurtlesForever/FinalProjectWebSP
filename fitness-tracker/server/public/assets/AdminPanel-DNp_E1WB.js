import{_ as N,r as u,e as y,p as S,c as n,a as e,t as i,g as q,w as x,f as p,v as _,s as B,F as D,q as F,o as d}from"./index-Dw9N7q9t.js";import{A as v}from"./api-WO6kZKM2.js";import"@oruga-ui/oruga-next/dist/oruga.css";const I={key:0,class:"admin-page min-h-screen flex flex-col items-center px-4 py-8 text-white"},L={class:"form-section w-full max-w-3xl bg-gray-800 p-6 rounded mb-8"},j={class:"text-2xl font-semibold mb-4"},z={class:"form-buttons flex gap-4"},R={type:"submit",class:"w-full py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700"},T={class:"users-section w-full max-w-3xl"},Y={key:0,class:"text-center text-gray-400"},G={key:1,class:"w-full table-auto bg-gray-800 text-white rounded-lg"},H={class:"p-4"},J={class:"p-4"},K={class:"p-4 flex gap-2"},O=["onClick"],Q=["onClick"],W={class:"pagination flex justify-between mt-4 text-white"},X=["disabled"],Z=["disabled"],ee={key:1,class:"no-access text-center py-8"},f=5,te={__name:"AdminPanel",setup(se){const g=u([]),o=u({username:"",password:"",role:"user"}),l=u(null),b=u(!0),r=u(1),w=y(()=>{var s;return((s=$store.state.user)==null?void 0:s.role)==="admin"}),U=y(()=>{const s=(r.value-1)*f;return g.value.slice(s,s+f)}),h=y(()=>Math.ceil(g.value.length/f)),c=async()=>{try{const{data:s}=await v.get("/users");g.value=s}catch{alert("Error fetching users")}finally{b.value=!1}},k=async()=>{try{await v.post("/users",o.value),m(),await c()}catch{alert("Error adding user")}},A=async()=>{try{await v.put(`/users/${l.value.id}`,o.value),m(),await c()}catch{alert("Error updating user")}},P=async s=>{try{await v.delete(`/users/${s}`),await c()}catch{alert("Error deleting user")}},C=s=>{l.value=s,o.value={...s,password:""}},E=()=>{m()},m=()=>{l.value=null,o.value={username:"",password:"",role:"user"}},$=()=>{r.value>1&&r.value--},M=()=>{r.value<h.value&&r.value++};return S(()=>{w.value&&c()}),(s,t)=>w.value?(d(),n("div",I,[t[7]||(t[7]=e("h2",{class:"text-3xl font-semibold mb-8"},"Admin Panel",-1)),e("section",L,[e("h3",j,i(l.value?"Edit User":"Add New User"),1),e("form",{onSubmit:t[3]||(t[3]=q(a=>l.value?A():k,["prevent"])),class:"space-y-4"},[x(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>o.value.username=a),type:"text",placeholder:"Username",required:"",class:"w-full p-3 bg-gray-700 border border-gray-600 rounded"},null,512),[[_,o.value.username]]),l.value?p("",!0):x((d(),n("input",{key:0,"onUpdate:modelValue":t[1]||(t[1]=a=>o.value.password=a),type:"password",placeholder:"Password",required:"",class:"w-full p-3 bg-gray-700 border border-gray-600 rounded"},null,512)),[[_,o.value.password]]),x(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>o.value.role=a),class:"w-full p-3 bg-gray-700 border border-gray-600 rounded"},t[4]||(t[4]=[e("option",{value:"user"},"User",-1),e("option",{value:"admin"},"Admin",-1)]),512),[[B,o.value.role]]),e("div",z,[e("button",R,i(l.value?"Update":"Add"),1),l.value?(d(),n("button",{key:0,type:"button",onClick:E,class:"w-full py-2 bg-gray-600 text-white rounded hover:bg-gray-700"},"Cancel")):p("",!0)])],32)]),e("section",T,[t[6]||(t[6]=e("h3",{class:"text-2xl font-semibold mb-4"},"Users",-1)),b.value?(d(),n("div",Y,"Loading users...")):p("",!0),b.value?p("",!0):(d(),n("table",G,[t[5]||(t[5]=e("thead",null,[e("tr",null,[e("th",{class:"p-4"},"Username"),e("th",{class:"p-4"},"Role"),e("th",{class:"p-4"},"Actions")])],-1)),e("tbody",null,[(d(!0),n(D,null,F(U.value,a=>(d(),n("tr",{key:a.id,class:"border-b border-gray-600"},[e("td",H,i(a.username),1),e("td",J,i(a.role),1),e("td",K,[e("button",{onClick:V=>C(a),class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"},"Edit",8,O),e("button",{onClick:V=>P(a.id),class:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700"},"Delete",8,Q)])]))),128))])])),e("div",W,[e("button",{onClick:$,disabled:r.value===1,class:"py-2 px-4 bg-gray-600 rounded hover:bg-gray-700"},"Prev",8,X),e("span",null,"Page "+i(r.value),1),e("button",{onClick:M,disabled:r.value>=h.value,class:"py-2 px-4 bg-gray-600 rounded hover:bg-gray-700"},"Next",8,Z)])])])):(d(),n("div",ee,t[8]||(t[8]=[e("p",{class:"text-lg text-gray-400"},"You do not have permission to view this page.",-1)])))}},re=N(te,[["__scopeId","data-v-39df4844"]]);export{re as default};
